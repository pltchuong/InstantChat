!function(){window.InstantChat=Ember.Application.create({ready:function(){socket=io.connect("http://instantchat.imphan.com/"),fingerprint=(new Fingerprint).get()}})}(),function(){InstantChat.IndexController=Ember.ObjectController.extend({init:function(){var a=this.store;socket.on("sendMessage",function(b){a.createRecord("message",{fingerprint:b.fingerprint,sender:b.sender,message:b.message}).save(),document.title=b.message}),socket.on("updateSender",function(b,c){a.find("message",{fingerprint:c}).then(function(a){a.content.forEach(function(a){a.set("sender",b)})})})},actions:{sendMessage:function(){if(this.get("message")){var a=this.store,b={fingerprint:fingerprint,sender:this.get("sender")?this.get("sender"):fingerprint,message:this.get("message")};a.createRecord("message",b).save(),socket.emit("sendMessage",b),document.title=b.message}},updateSender:function(){var a=this.store,b=this.get("sender")?this.get("sender"):fingerprint;a.find("message",{fingerprint:fingerprint}).then(function(a){a.content.forEach(function(a){a.set("sender",b)})}),socket.emit("updateSender",b,fingerprint)}}})}(),function(){InstantChat.ApplicationAdapter=DS.FixtureAdapter.extend({queryFixtures:function(a,b){return a.filter(function(a){for(var c in b)if(a[c]!==b[c])return!1;return!0})}})}(),function(){InstantChat.Message=DS.Model.extend({message:DS.attr("string"),sender:DS.attr("string"),fingerprint:DS.attr("number"),meta:DS.attr("string"),created:DS.attr("date"),updated:DS.attr("date")}),InstantChat.Message.FIXTURES=[]}(),function(){InstantChat.IndexRoute=Ember.Route.extend({model:function(){return this.get("store").find("message")}})}(),function(){InstantChat.MessagesView=Ember.View.extend({scrollToBottom:function(){jQuery(".messages").scrollTop(jQuery(".messages")[0].scrollHeight)}.observes("controller.model.length")}),InstantChat.SenderView=Ember.View.extend({keyUp:function(){this.get("controller").send("updateSender")}}),InstantChat.MessageView=Ember.View.extend({keyPress:function(a){return a.ctrlKey||13!==a.keyCode?void 0:(this.get("controller").send("sendMessage"),this.get("controller").set("message",""),!1)}}),InstantChat.SendButtonView=Ember.View.extend({tagName:"span",click:function(){this.get("controller").set("message","")}})}(),function(){Ember.Handlebars.helper("messageHelper",function(a){a=a.replace(/:\)/gi,'<img src="images/emoticons/yahoo/1.gif" />').replace(/:\(/gi,'<img src="images/emoticons/yahoo/2.gif" />').replace(/;\)/gi,'<img src="images/emoticons/yahoo/3.gif" />').replace(/:D/gi,'<img src="images/emoticons/yahoo/4.gif" />').replace(/;;\)/gi,'<img src="images/emoticons/yahoo/5.gif" />').replace(/>:D</gi,'<img src="images/emoticons/yahoo/6.gif" />').replace(/:-\//gi,'<img src="images/emoticons/yahoo/7.gif" />').replace(/:x/gi,'<img src="images/emoticons/yahoo/8.gif" />').replace(/:">/gi,'<img src="images/emoticons/yahoo/9.gif" />').replace(/:P/gi,'<img src="images/emoticons/yahoo/10.gif" />').replace(/:-\*/gi,'<img src="images/emoticons/yahoo/11.gif" />').replace(/=\(\(/gi,'<img src="images/emoticons/yahoo/12.gif" />');var b=["fuck","ass","shit"];return b.forEach(function(b){a=a.replace(b,"*****")}),new Handlebars.SafeString(a)})}(),function(){InstantChat.Router.map(function(){})}();