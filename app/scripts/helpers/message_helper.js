Ember.Handlebars.helper('messageHelper', function(value, options) {
  
  // add emoticons
  var emoticons = options.data.view.get('controller').get('emoticons');
  if(!emoticons || emoticons == 'yahoo') {
    value = value
      .replace(/(:\(\()/gi,   '<img src="images/emoticons/yahoo/20.gif" />')  
      .replace(/(:\)\))/gi,   '<img src="images/emoticons/yahoo/21.gif" />')  
      .replace(/(\/:\))/gi,   '<img src="images/emoticons/yahoo/23.gif" />')
      .replace(/(>:\))/gi,    '<img src="images/emoticons/yahoo/19.gif" />')  
      .replace(/(:\)\])/gi,   '<img src="images/emoticons/yahoo/100.gif" />')
      .replace(/(<\):\))/gi,  '<img src="images/emoticons/yahoo/48.gif" />')
      .replace(/(:\(\|\))/gi, '<img src="images/emoticons/yahoo/51.gif" />')
      .replace(/(\*-:\))/gi,  '<img src="images/emoticons/yahoo/58.gif" />')
      .replace(/(=:\))/gi,    '<img src="images/emoticons/yahoo/60.gif" />')
      .replace(/(:\)>-)/gi,   '<img src="images/emoticons/yahoo/67.gif" />')
      .replace(/(\^:\)\^)/gi, '<img src="images/emoticons/yahoo/77.gif" />')
      .replace(/(:\))/gi,     '<img src="images/emoticons/yahoo/1.gif" />')
      .replace(/(:\()/gi,     '<img src="images/emoticons/yahoo/2.gif" />')
      .replace(/(;;\))/gi,    '<img src="images/emoticons/yahoo/5.gif" />')
      .replace(/(=;)/gi,      '<img src="images/emoticons/yahoo/27.gif" />')
      .replace(/(;\)\))/gi,   '<img src="images/emoticons/yahoo/71.gif" />')
      .replace(/(;\))/gi,     '<img src="images/emoticons/yahoo/3.gif" />')
      .replace(/(>:d<)/gi,    '<img src="images/emoticons/yahoo/6.gif" />')
      .replace(/(\\:d\/)/gi,  '<img src="images/emoticons/yahoo/69.gif" />')
      .replace(/(:d)/gi,      '<img src="images/emoticons/yahoo/4.gif" />')
      .replace(/(:-\/)/gi,    '<img src="images/emoticons/yahoo/7.gif" />')
      .replace(/(:x)/gi,      '<img src="images/emoticons/yahoo/8.gif" />')
      .replace(/(:">)/gi,     '<img src="images/emoticons/yahoo/9.gif" />')
      .replace(/(>:p)/gi,     '<img src="images/emoticons/yahoo/47.gif" />')
      .replace(/(:p)/gi,      '<img src="images/emoticons/yahoo/10.gif" />')
      .replace(/(:-\*)/gi,    '<img src="images/emoticons/yahoo/11.gif" />')
      .replace(/(=\(\()/gi,   '<img src="images/emoticons/yahoo/12.gif" />')
      .replace(/(3:-o)/gi,    '<img src="images/emoticons/yahoo/50.gif" />')
      .replace(/(:-o)/gi,     '<img src="images/emoticons/yahoo/13.gif" />')
      .replace(/(~x\()/gi,    '<img src="images/emoticons/yahoo/102.gif" />')
      .replace(/(x\()/gi,     '<img src="images/emoticons/yahoo/14.gif" />')
      .replace(/(~:>)/gi,     '<img src="images/emoticons/yahoo/52.gif" />')
      .replace(/(:>)/gi,      '<img src="images/emoticons/yahoo/15.gif" />')
      .replace(/(b-\))/gi,    '<img src="images/emoticons/yahoo/16.gif" />')
      .replace(/(#:-s)/gi,    '<img src="images/emoticons/yahoo/18.gif" />')
      .replace(/(:-ss)/gi,    '<img src="images/emoticons/yahoo/42.gif" />')
      .replace(/(:-s)/gi,     '<img src="images/emoticons/yahoo/17.gif" />')
      .replace(/(\(:\|)/gi,   '<img src="images/emoticons/yahoo/37.gif" />')
      .replace(/(:\|)/gi,     '<img src="images/emoticons/yahoo/22.gif" />')
      .replace(/(=\)\))/gi,   '<img src="images/emoticons/yahoo/24.gif" />')
      .replace(/(o:-\))/gi,   '<img src="images/emoticons/yahoo/25.gif" />')
      .replace(/(:-bd)/gi,    '<img src="images/emoticons/yahoo/113.gif" />')
      .replace(/(:-b)/gi,     '<img src="images/emoticons/yahoo/26.gif" />')
      .replace(/(:-c)/gi,     '<img src="images/emoticons/yahoo/101.gif" />')
      .replace(/(:-h)/gi,     '<img src="images/emoticons/yahoo/103.gif" />')
      .replace(/(:-t)/gi,     '<img src="images/emoticons/yahoo/104.gif" />')
      .replace(/(8->)/gi,     '<img src="images/emoticons/yahoo/105.gif" />')
      .replace(/(i-\))/gi,    '<img src="images/emoticons/yahoo/28.gif" />')
      .replace(/(8-\|)/gi,    '<img src="images/emoticons/yahoo/29.gif" />')
      .replace(/(l-\))/gi,    '<img src="images/emoticons/yahoo/30.gif" />')
      .replace(/(:-\&)/gi,    '<img src="images/emoticons/yahoo/31.gif" />')
      .replace(/(:-\$)/gi,    '<img src="images/emoticons/yahoo/32.gif" />')
      .replace(/(\[-\()/gi,   '<img src="images/emoticons/yahoo/33.gif" />')
      .replace(/(:o\))/gi,    '<img src="images/emoticons/yahoo/34.gif" />')
      .replace(/(8-\})/gi,    '<img src="images/emoticons/yahoo/35.gif" />')
      .replace(/(<:-p)/gi,    '<img src="images/emoticons/yahoo/36.gif" />')
      .replace(/(=p~)/gi,     '<img src="images/emoticons/yahoo/38.gif" />')
      .replace(/(:-\?\?)/gi,  '<img src="images/emoticons/yahoo/106.gif" />')
      .replace(/(:-\?)/gi,    '<img src="images/emoticons/yahoo/39.gif" />')
      .replace(/(#-o)/gi,     '<img src="images/emoticons/yahoo/40.gif" />')
      .replace(/(=d>)/gi,     '<img src="images/emoticons/yahoo/41.gif" />')
      .replace(/(@-\))/gi,    '<img src="images/emoticons/yahoo/43.gif" />')
      .replace(/(:\^o)/gi,    '<img src="images/emoticons/yahoo/44.gif" />')
      .replace(/(:-w)/gi,     '<img src="images/emoticons/yahoo/45.gif" />')
      .replace(/(:-<)/gi,     '<img src="images/emoticons/yahoo/46.gif" />')
      .replace(/(x_x)/gi,     '<img src="images/emoticons/yahoo/109.gif" />')
      .replace(/(:!!)/gi,     '<img src="images/emoticons/yahoo/110.gif" />')
      .replace(/(\\m\/)/gi,   '<img src="images/emoticons/yahoo/111.gif" />')
      .replace(/(:-q)/gi,     '<img src="images/emoticons/yahoo/112.gif" />')
      .replace(/(\^#\(\^)/gi, '<img src="images/emoticons/yahoo/114.gif" />')
      .replace(/(:o3)/gi,     '<img src="images/emoticons/yahoo/108.gif" />')
      .replace(/(%-\()/gi,    '<img src="images/emoticons/yahoo/107.gif" />')
      .replace(/(:@\))/gi,    '<img src="images/emoticons/yahoo/49.gif" />')
      .replace(/(@\};-)/gi,   '<img src="images/emoticons/yahoo/53.gif" />')
      .replace(/(%%-)/gi,     '<img src="images/emoticons/yahoo/54.gif" />')
      .replace(/(\*\*==)/gi,  '<img src="images/emoticons/yahoo/55.gif" />')
      .replace(/(\(~~\))/gi,  '<img src="images/emoticons/yahoo/56.gif" />')
      .replace(/(~o\))/gi,    '<img src="images/emoticons/yahoo/57.gif" />')
      .replace(/(8-x)/gi,     '<img src="images/emoticons/yahoo/59.gif" />')
      .replace(/(>-\))/gi,    '<img src="images/emoticons/yahoo/61.gif" />')
      .replace(/(:-l)/gi,     '<img src="images/emoticons/yahoo/62.gif" />')
      .replace(/(\[-o<)/gi,   '<img src="images/emoticons/yahoo/63.gif" />')
      .replace(/(\$-\))/gi,   '<img src="images/emoticons/yahoo/64.gif" />')
      .replace(/(:-")/gi,     '<img src="images/emoticons/yahoo/65.gif" />')
      .replace(/(b-\()/gi,    '<img src="images/emoticons/yahoo/66.gif" />')
      .replace(/(\[-x)/gi,    '<img src="images/emoticons/yahoo/68.gif" />')
      .replace(/(>:\/)/gi,    '<img src="images/emoticons/yahoo/70.gif" />')
      .replace(/(:-@)/gi,     '<img src="images/emoticons/yahoo/76.gif" />')
      .replace(/(:-j)/gi,     '<img src="images/emoticons/yahoo/78.gif" />')
      .replace(/(\(\*\))/gi,  '<img src="images/emoticons/yahoo/79.gif" />')
      .replace(/(o->)/gi,     '<img src="images/emoticons/yahoo/72.gif" />')
      .replace(/(o=>)/gi,     '<img src="images/emoticons/yahoo/73.gif" />')
      .replace(/(o-\+)/gi,    '<img src="images/emoticons/yahoo/74.gif" />')
      .replace(/(\(%\))/gi,   '<img src="images/emoticons/yahoo/75.gif" />')
      .replace(/(:bz)/gi,     '<img src="images/emoticons/yahoo/115.gif" />')
      .replace(/(\[..\])/gi,  '<img src="images/emoticons/yahoo/transformer.gif" />')
      .replace(/(:ar!)/gi,    '<img src="images/emoticons/yahoo/pirate_2.gif" />')  
    ;
  } else {
    value = value
      .replace(/(\]:\))|(\>:\))|(\(grin\))/gi,                          '<img src="images/emoticons/skype/eg.gif" />')
      .replace(/(\(dance\))|(\\o\/)|(\\:d\/)/gi,                        '<img src="images/emoticons/skype/dance.gif" />')
      .replace(/(:\))|(:=\))|(:-\))/gi,                                 '<img src="images/emoticons/skype/smile.gif" />')
      .replace(/(:\()|(:=\()|(:-\()/gi,                                 '<img src="images/emoticons/skype/sad.gif" />')
      .replace(/(:d)|(:=d)|(:-d)/gi,                                    '<img src="images/emoticons/skype/laugh.gif" />')
      .replace(/(8=\))|(8-\))|(b=\))|(b-\))|(\(cool\))/gi,              '<img src="images/emoticons/skype/cool.gif" />')
      .replace(/(;\))|(;-\))|(;=\))/gi,                                 '<img src="images/emoticons/skype/wink.gif" />')
      .replace(/(:o)|(:=o)|(:-o)/gi,                                    '<img src="images/emoticons/skype/surprised.gif" />')
      .replace(/(;\()|(;-\()|(;=\()/gi,                                 '<img src="images/emoticons/skype/cry.gif" />')
      .replace(/(\(sweat\))|(\(:\|)/gi,                                 '<img src="images/emoticons/skype/sweat.gif" />')
      .replace(/(:\|)|(:=\|)|(:-\|)/gi,                                 '<img src="images/emoticons/skype/speechless.gif" />')
      .replace(/(:\*)|(:=\*)|(:-\*)/gi,                                 '<img src="images/emoticons/skype/kiss.gif" />')
      .replace(/(:p)|(:=p)|(:-p)/gi,                                    '<img src="images/emoticons/skype/tongueout.gif" />')
      .replace(/(\(yn\))/gi,                                            '<img src="images/emoticons/skype/fingerscrossed.gif" />')
      .replace(/(\(blush\))|(:\$)|(:-\$)|(:=\$)|(:">)/gi,               '<img src="images/emoticons/skype/blush.gif" />')
      .replace(/(:\^\))/gi,                                             '<img src="images/emoticons/skype/wonder.gif" />')
      .replace(/(\|-\))|(I-\))|(I=\))|\(snooze\)/gi,                    '<img src="images/emoticons/skype/sleepy.gif" />')
      .replace(/(\|\()|(\|-\()|(\|=\()/gi,                              '<img src="images/emoticons/skype/dull.gif" />')
      .replace(/(\(inlove\))/gi,                                        '<img src="images/emoticons/skype/inlove.gif" />')
      .replace(/(\(yawn\))/gi,                                          '<img src="images/emoticons/skype/yawn.gif" />')
      .replace(/(\(puke\))|(:&)|(:-&)|(:=&)/gi,                         '<img src="images/emoticons/skype/puke.gif" />')
      .replace(/(\(doh\))/gi,                                           '<img src="images/emoticons/skype/doh.gif" />')
      .replace(/(:@)|(:-@)|(:=@)|(x\()|(x-\()|(x=\()/gi,                '<img src="images/emoticons/skype/angry.gif" />')
      .replace(/(\(wasntme\))/gi,                                       '<img src="images/emoticons/skype/wasntme.gif" />')
      .replace(/(\(party\))/gi,                                         '<img src="images/emoticons/skype/party.gif" />')
      .replace(/(\(facepalm\))/gi,                                      '<img src="images/emoticons/skype/facepalm.gif" />')
      .replace(/(:s)|(:-s)|(:=s)/gi,                                    '<img src="images/emoticons/skype/worry.gif" />')
      .replace(/(\(mm\))/gi,                                            '<img src="images/emoticons/skype/mmm.gif" />')
      .replace(/(8-\|)|(b-\|)|(8\|)|(b\|)|(8=\|)|(b=\|)|(\(nerd\))/gi,  '<img src="images/emoticons/skype/nerdy.gif" />')
      .replace(/(:x)|(:-x)|(:=x)|(:#)|(:-#)|(:=#)/gi,                   '<img src="images/emoticons/skype/lipssealed.gif" />')
      .replace(/(\(hi\))/gi,                                            '<img src="images/emoticons/skype/hi.gif" />')
      .replace(/(\(devil\))/gi,                                         '<img src="images/emoticons/skype/devil.gif" />')
      .replace(/(\(angel\))/gi,                                         '<img src="images/emoticons/skype/angel.gif" />')
      .replace(/(\(envy\))/gi,                                          '<img src="images/emoticons/skype/envy.gif" />')
      .replace(/(\(wait\))/gi,                                          '<img src="images/emoticons/skype/wait.gif" />')
      .replace(/(\(bear\))|(\(hug\))/gi,                                '<img src="images/emoticons/skype/hug.gif" />')
      .replace(/(\(makeup\))|(\(kate\))/gi,                             '<img src="images/emoticons/skype/makeup.gif" />')
      .replace(/(\(giggle\))|(\(chuckle\))/gi,                          '<img src="images/emoticons/skype/giggle.gif" />')
      .replace(/(\(clap\))/gi,                                          '<img src="images/emoticons/skype/clap.gif" />')
      .replace(/(\(think\))|(:\?)|(:-\?)|(:=\?)/gi,                     '<img src="images/emoticons/skype/think.gif" />')
      .replace(/(\(bow\))/gi,                                           '<img src="images/emoticons/skype/bow.gif" />')
      .replace(/(\(rofl\))/gi,                                          '<img src="images/emoticons/skype/rofl.gif" />')
      .replace(/(\(whew\))/gi,                                          '<img src="images/emoticons/skype/whew.gif" />')
      .replace(/(\(happy\))/gi,                                         '<img src="images/emoticons/skype/happy.gif" />')
      .replace(/(\(smirk\))/gi,                                         '<img src="images/emoticons/skype/smirk.gif" />')
      .replace(/(\(nod\))/gi,                                           '<img src="images/emoticons/skype/nod.gif" />')
      .replace(/(\(shake\))/gi,                                         '<img src="images/emoticons/skype/shake.gif" />')
      .replace(/(\(emo\))/gi,                                           '<img src="images/emoticons/skype/emo.gif" />')
      .replace(/(\(y\))|(\(ok\))/gi,                                    '<img src="images/emoticons/skype/yes.gif" />')
      .replace(/(\(n\))/gi,                                             '<img src="images/emoticons/skype/no.gif" />')
      .replace(/(\(handshake\))/gi,                                     '<img src="images/emoticons/skype/handshake.gif" />')
      .replace(/(\(h\))|(\(l\))/gi,                                     '<img src="images/emoticons/skype/heart.gif" />')
      .replace(/(\(tmi\))/gi,                                           '<img src="images/emoticons/skype/tmi.gif" />')
      .replace(/(\(heidy\))/gi,                                         '<img src="images/emoticons/skype/heidy.gif" />')
      .replace(/(\(f\))/gi,                                             '<img src="images/emoticons/skype/flower.gif" />')
      .replace(/(\(rain\))|(\(london\))|(\(st\))/gi,                    '<img src="images/emoticons/skype/rain.gif" />')
      .replace(/(\(sun\))/gi,                                           '<img src="images/emoticons/skype/sun.gif" />')
      .replace(/(\(music\))/gi,                                         '<img src="images/emoticons/skype/music.gif" />')
      .replace(/(\(coffee\))/gi,                                        '<img src="images/emoticons/skype/coffee.gif" />')
      .replace(/(\(pizza\))|(\(pi\))/gi,                                '<img src="images/emoticons/skype/pizza.gif" />')
      .replace(/(\(cash\))|(\(mo\))|(\(\$\))/gi,                        '<img src="images/emoticons/skype/cash.gif" />')
      .replace(/(\(muscle\))|(\(flex\))/gi,                             '<img src="images/emoticons/skype/muscle.gif" />')
      .replace(/(\(\^\))|(\(cake\))/gi,                                 '<img src="images/emoticons/skype/cake.gif" />')
      .replace(/(\(beer\))/gi,                                          '<img src="images/emoticons/skype/beer.gif" />')
      .replace(/(\(d\))/gi,                                             '<img src="images/emoticons/skype/drink.gif" />')
      .replace(/(\(ninja\))/gi,                                         '<img src="images/emoticons/skype/ninja.gif" />')
      .replace(/(\(\*\))/gi,                                            '<img src="images/emoticons/skype/star.gif" />')
      .replace(/(\(tumbleweed\))/gi,                                    '<img src="images/emoticons/skype/tumbleweed.gif" />')
      .replace(/(\(bandit\))/gi,                                        '<img src="images/emoticons/skype/bandit.gif" />')
      .replace(/(\(call\))/gi,                                          '<img src="images/emoticons/skype/call.gif" />')
      .replace(/(\(talk\))/gi,                                          '<img src="images/emoticons/skype/talk.gif" />')
      .replace(/(\(u\))/gi,                                             '<img src="images/emoticons/skype/brokenheart.gif" />')
      .replace(/(\(o\))|(\(time\))/gi,                                  '<img src="images/emoticons/skype/time.gif" />')
      .replace(/(\(e\))|(\(m\))/gi,                                     '<img src="images/emoticons/skype/mail.gif" />')
      .replace(/(\(\~\))|(\(film\))|(\(movie\))/gi,                     '<img src="images/emoticons/skype/movie.gif" />')
      .replace(/(\(mp\))|(\(ph\))/gi,                                   '<img src="images/emoticons/skype/phone.gif" />')
      .replace(/(\(drunk\))/gi,                                         '<img src="images/emoticons/skype/drunk.gif" />')
      .replace(/(\(punch\))/gi,                                         '<img src="images/emoticons/skype/punch.gif" />')
      .replace(/(\(smoking\))|(\(smoke\))|(\(ci\))/gi,                  '<img src="images/emoticons/skype/smoke.gif" />')
      .replace(/(\(toivo\))/gi,                                         '<img src="images/emoticons/skype/toivo.gif" />')
      .replace(/(\(rock\))/gi,                                          '<img src="images/emoticons/skype/rock.gif" />')
      .replace(/(\(headbang\))|(\(banghead\))/gi,                       '<img src="images/emoticons/skype/headbang.gif" />')
      .replace(/(\(bug\))/gi,                                           '<img src="images/emoticons/skype/bug.gif" />')
      .replace(/(\(poolparty\))/gi,                                     '<img src="images/emoticons/skype/poolparty.gif" />')
      .replace(/(\(bertlett\))/gi,                                      '<img src="images/emoticons/skype/bertlett.gif" />')
      .replace(/(\(finger\))/gi,                                        '<img src="images/emoticons/skype/finger.gif" />')
      .replace(/(\(wfh\))/gi,                                           '<img src="images/emoticons/skype/wfh.gif" />')
      .replace(/(\(priidu\))/gi,                                        '<img src="images/emoticons/skype/priidu.gif" />')
      .replace(/(\(mooning\))/gi,                                       '<img src="images/emoticons/skype/mooning.gif" />')
      .replace(/(\(malthe\))/gi,                                        '<img src="images/emoticons/skype/malthe.gif" />')
      .replace(/(\(lalala\))/gi,                                        '<img src="images/emoticons/skype/lalala.gif" />')
      .replace(/(\(oliver\))/gi,                                        '<img src="images/emoticons/skype/oliver.gif" />')
      .replace(/(\(swear\))/gi,                                         '<img src="images/emoticons/skype/swear.gif" />')
      .replace(/(\(highfive\))/gi,                                      '<img src="images/emoticons/skype/highfive.gif" />')
      .replace(/(\(waiting\))/gi,                                       '<img src="images/emoticons/skype/waiting.gif" />')
      .replace(/(\(hollest\))/gi,                                       '<img src="images/emoticons/skype/hollest.gif" />')
      .replace(/(\(wtf\))/gi,                                           '<img src="images/emoticons/skype/wtf.gif" />')
    ;
  }
  
  // remove bad words
  var filter = ['fuck', 'ass', 'shit'];
  filter.forEach(function(word) {
    value = value.replace(new RegExp('\\b' + word + '\\b', 'gi'), '*****');
  });
  
  // add link to image
  //value = value.replace(/<img src="([^"]*)"[^>]*>/gi, '<a href="$1" target="_blank"><img src="$1" /></a>')

  // process something else
  
  return new Handlebars.SafeString(value);
});